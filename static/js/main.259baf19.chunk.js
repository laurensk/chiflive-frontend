(this["webpackJsonpchiflive-frontend"]=this["webpackJsonpchiflive-frontend"]||[]).push([[0],{39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},60:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n(0),r=n.n(s),i=n(31),o=n.n(i),c=(n(39),n(40),n(32)),u=n(3),l=n(4),d=n(11),v=n(16),h=n(15),f=(n(41),n(2)),g=n.n(f),p=n(6),m=function e(t){Object(l.a)(this,e),this.isLiveEvent=void 0,this.isLiveEvent=t},b=function e(t,n,a,s,r){Object(l.a)(this,e),this.id=void 0,this.author=void 0,this.body=void 0,this.creationDate=void 0,this.read=void 0,this.id=t,this.author=n,this.body=a,this.creationDate=s,this.read=r},j=function e(t,n,a){Object(l.a)(this,e),this.id=void 0,this.name=void 0,this.login=void 0,this.id=t,this.name=n,this.login=a},O=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"login",value:function(e,t,n){localStorage.setItem("CL_API_USERNAME",e),localStorage.setItem("CL_API_TOKEN",t),localStorage.setItem("CL_API_NAME",n)}},{key:"logout",value:function(){localStorage.removeItem("CL_API_USERNAME"),localStorage.removeItem("CL_API_TOKEN"),localStorage.removeItem("CL_API_NAME")}},{key:"getLoginData",value:function(){return{username:localStorage.getItem("CL_API_USERNAME")||"",password:localStorage.getItem("CL_API_TOKEN")||""}}},{key:"getName",value:function(){return localStorage.getItem("CL_API_NAME")}},{key:"isLoggedIn",value:function(){var t=e.getLoginData();return t.username.length>=1||t.password.length>=1}},{key:"saveAuthorName",value:function(e){localStorage.setItem("CL_API_AUTHOR",e)}},{key:"getAuthorName",value:function(){return localStorage.getItem("CL_API_AUTHOR")||""}}]),e}(),y=n(13),L=n(17),k=n.n(L),E=function e(t,n){Object(l.a)(this,e),this.message=void 0,this.statusCode=void 0,this.message=t,this.statusCode=n},x=function e(t){Object(l.a)(this,e),this.success=void 0,this.success=t},N=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"responseHandler",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n,a,s){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.values(t.data)[0],s(r,null);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,s){return e.apply(this,arguments)}}()},{key:"errorHandler",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n){var a,s,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.response&&t.response.data){e.next=2;break}return e.abrupt("return",n(null,new E("UNKNOWN_ERROR",400)));case 2:if(void 0==t.response.data.error.message){e.next=9;break}return a=t.response.data.error.statusCode,s=t.response.data.error.message,r=new E(s,a),e.abrupt("return",n(null,r));case 9:return i=new E("UNKNOWN_ERROR",400),e.abrupt("return",n(null,i));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n,a,s,r,i){var o,c,u=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this.apiEndpoint+t,c=r?Object(y.a)(Object(y.a)({},O.getLoginData()),n):n,k.a.get(o,{data:c}).then((function(e){return u.responseHandler(e,a,s,i)})).catch((function(e){return u.errorHandler(e,i)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,a,s,r,i){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n,a,s,r,i){var o,c,u=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this.apiEndpoint+t,c=r?Object(y.a)(Object(y.a)({},O.getLoginData()),n):n,k.a.post(o,c).then((function(e){return u.responseHandler(e,a,s,i)})).catch((function(e){return u.errorHandler(e,i)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,a,s,r,i){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n,a,s){var r,i,o=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.apiEndpoint+t,i=a?Object(y.a)(Object(y.a)({},O.getLoginData()),n):n,k.a.delete(r,{data:i}).then((function(e){return o.responseHandler(e,x,!1,s)})).catch((function(e){return o.errorHandler(e,s)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,a,s){return e.apply(this,arguments)}}()}]),e}();N.apiEndpoint="https://chiflive.api.laurensk.at";var I=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"getAllMessages",value:function(){var e=Object(p.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/messages/get",{},b,!0,!0,(function(e,n){t(e,n)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteMessage",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/messages/delete",{messageId:t},x,!1,!0,(function(e,t){n(e,t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"toggleReadStatus",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/messages/toggleReadStatus",{messageId:t},x,!1,!0,(function(e,t){n(e,t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"postMessage",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n,a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/messages",{author:t,body:n},x,!1,!1,(function(e,t){console.log(t),a(e,t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getLiveEvent",value:function(){var e=Object(p.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/properties/isLiveEvent",{},m,!1,!1,(function(e,n){t(e,n)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleLiveEvent",value:function(){var e=Object(p.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/properties/toggleLiveEvent",{},x,!1,!0,(function(e,n){t(e,n)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(p.a)(g.a.mark((function e(t,n,a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.post("/user",{username:t,password:n},j,!1,!1,(function(e,s){s||O.login(t,n,e.name),a(e,s)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()}]),e}(),w=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).liveEventInterval=void 0,a.state={author:O.getAuthorName(),body:"",isLiveEvent:!0},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateLiveEvent(),this.liveEventInterval=setInterval((function(){return e.updateLiveEvent()}),1e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.liveEventInterval)}},{key:"updateLiveEvent",value:function(){var e=this;I.getLiveEvent((function(t,n){n||e.setState({isLiveEvent:t.isLiveEvent})}))}},{key:"sendMessage",value:function(e){var t=this;e.preventDefault(),this.state.isLiveEvent?I.postMessage(this.state.author,this.state.body,(function(e,n){if(n)return alert("Error sending message. Please try again!");t.setState({body:""}),alert("Message sent successfully!")})):alert("You can only send messages during a live event. Please come back later!")}},{key:"authorChanged",value:function(e){O.saveAuthorName(e.target.value),this.setState({author:e.target.value})}},{key:"bodyChanged",value:function(e){this.setState({body:e.target.value})}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)("h1",{className:"title",children:"CHIFLIVE"}),Object(a.jsx)("h2",{className:"subtitle",children:"ADD YOUR COMMENT TO CHIFLIVE NOW!"}),Object(a.jsx)("div",{className:"form-container",children:Object(a.jsxs)("form",{className:"form-element",onSubmit:function(t){return e.sendMessage(t)},children:[Object(a.jsx)("input",{className:"author-input",placeholder:"Author (optional)",type:"text",value:this.state.author,onChange:function(t){return e.authorChanged(t)}}),Object(a.jsx)("textarea",{className:"body-input",placeholder:"Your Message",value:this.state.body,onChange:function(t){return e.bodyChanged(t)}}),Object(a.jsx)("button",{className:"button-input",type:"submit",children:"Post Message"})]})})]})}}]),n}(r.a.Component),M=(n(60),function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).interval=void 0,a.adminLiveEventInterval=void 0,a.state={isLoggedIn:O.isLoggedIn(),username:"",password:"",user:void 0,messages:[],sec:5,isLiveEvent:!0},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.getMessages(!1),document.body.style.backgroundImage="none",this.interval=setInterval((function(){return e.getMessages(!1)}),1e3),this.updateLiveEvent(),this.adminLiveEventInterval=setInterval((function(){return e.updateLiveEvent()}),1e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval),clearInterval(this.adminLiveEventInterval)}},{key:"updateLiveEvent",value:function(){var e=this;I.getLiveEvent((function(t,n){n||e.setState({isLiveEvent:t.isLiveEvent})}))}},{key:"toggleLiveEvent",value:function(){var e=this;I.toggleLiveEvent((function(t,n){n||e.updateLiveEvent()}))}},{key:"login",value:function(e){var t=this;e.preventDefault(),I.login(this.state.username,this.state.password,(function(e,n){n?(console.log(n),t.setState({isLoggedIn:!1,password:""}),alert("Login failed. Please try again!")):t.setState({user:e,isLoggedIn:O.isLoggedIn(),username:"",password:""})}))}},{key:"renderLogin",value:function(){var e=this;return Object(a.jsxs)("div",{className:"admin-container",children:[Object(a.jsx)("h1",{className:"admin-title",children:"CHIFLIVE"}),Object(a.jsx)("h2",{className:"admin-subtitle",children:"LOGIN TO MANAGE MESSAGES!"}),Object(a.jsx)("div",{className:"admin-form-container",children:Object(a.jsxs)("form",{className:"admin-form-element",onSubmit:function(t){return e.login(t)},children:[Object(a.jsx)("input",{className:"admin-input",placeholder:"Username",type:"text",value:this.state.username,onChange:function(t){return e.setState({username:t.target.value})}}),Object(a.jsx)("input",{className:"admin-input",placeholder:"Password",type:"password",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}}),Object(a.jsx)("button",{className:"admin-button",type:"submit",children:"Login"})]})})]})}},{key:"getMessages",value:function(e){var t=this;this.state.isLoggedIn&&this.state.sec>=5||e?I.getAllMessages((function(e,n){n||t.setState({messages:t.sortMessages(e),sec:0})})):this.setState({sec:this.state.sec+1})}},{key:"sortMessages",value:function(e){return e.sort((function(e,t){return Number(e.read)-Number(t.read)}))}},{key:"renderAdmin",value:function(){var e=this;return Object(a.jsxs)("div",{className:"admin-container",children:[Object(a.jsx)("h1",{className:"admin-title",children:"CHIFLIVE"}),Object(a.jsxs)("h2",{className:"admin-subtitle",children:["Welcome, ",O.getName()]}),Object(a.jsxs)("h2",{onClick:function(){return e.toggleLiveEvent()},style:{textDecoration:"underline",cursor:"pointer",marginTop:5},className:"admin-subtitle",children:["Turn LiveEvent ",this.state.isLiveEvent?"OFF":"ON"]}),Object(a.jsx)("h2",{onClick:function(){O.logout(),e.setState({isLoggedIn:!1})},style:{textDecoration:"underline",cursor:"pointer"},className:"admin-subtitle",children:"Logout"}),Object(a.jsxs)("div",{className:"mes-container",children:[this.state.messages.map((function(t){return e.renderMessage(t)})),Object(a.jsxs)("div",{className:"updated-sec",children:["Updated ",this.state.sec," seconds ago..."]})]})]})}},{key:"toogleRead",value:function(e){var t=this;I.toggleReadStatus(e.id,(function(e,n){n||t.getMessages(!0)}))}},{key:"deleteMessage",value:function(e){var t=this;I.deleteMessage(e.id,(function(e,n){n||t.getMessages(!0)}))}},{key:"renderMessage",value:function(e){var t=this;return Object(a.jsxs)("div",{className:"mes-message-container",style:e.read?{opacity:.5}:void 0,children:[Object(a.jsxs)("div",{className:"message-detail",children:[Object(a.jsx)("div",{className:"mes-author",children:e.author.length>0?e.author:"No Author"}),Object(a.jsx)("div",{className:"mes-body",children:e.body})]}),Object(a.jsxs)("div",{className:"admin-buttons",children:[Object(a.jsx)("button",{onClick:function(){return t.toogleRead(e)},className:"action-button",children:e.read?"Mark as Unread":"Mark as Read"}),Object(a.jsx)("button",{onClick:function(){return t.deleteMessage(e)},className:"action-button",children:"Delete"})]})]},e.id)}},{key:"render",value:function(){return Object(a.jsxs)("div",{children:[this.state.isLoggedIn&&this.renderAdmin(),!this.state.isLoggedIn&&this.renderLogin()]})}}]),n}(r.a.Component));var S=function(){return Object(a.jsx)(c.a,{children:Object(a.jsx)("div",{children:Object(a.jsxs)(u.c,{children:[Object(a.jsx)(u.a,{path:"/admin",children:Object(a.jsx)(M,{})}),Object(a.jsx)(u.a,{path:"/",children:Object(a.jsx)(w,{})})]})})})};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(S,{})}),document.getElementById("root"))}},[[66,1,2]]]);
//# sourceMappingURL=main.259baf19.chunk.js.map